<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—í¬ë¦° ë•€ìƒ˜ ì´ì˜¨ ì±„ë„ ì‹œë®¬ë ˆì´ì…˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 1500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 2.5em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .simulation-container {
            display: grid;
            grid-template-columns: 1.2fr 0.8fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .gland-visual {
            position: relative;
            background: linear-gradient(to bottom, #fff5e6 0%, #ffe0cc 50%, #ffd4b3 100%);
            border-radius: 15px;
            padding: 20px;
            height: 650px;
            overflow: hidden;
            border: 3px solid #ff9800;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            height: 650px;
            overflow-y: auto;
        }
        
        /* í”¼ë¶€ì¸µ */
        .epidermis {
            position: absolute;
            width: 100%;
            height: 100px;
            top: 0;
            left: 0;
            background: linear-gradient(to bottom, 
                rgba(255, 221, 187, 0.9), 
                rgba(255, 204, 170, 0.9));
            border-bottom: 3px solid #d4a373;
            z-index: 2;
        }
        
        .epidermis-label {
            text-align: center;
            padding: 10px;
            color: #8b4513;
            font-weight: bold;
            font-size: 16px;
        }
        
        .dermis {
            position: absolute;
            width: 100%;
            height: 550px;
            top: 100px;
            left: 0;
            background: linear-gradient(to bottom, 
                rgba(255, 204, 170, 0.7), 
                rgba(255, 170, 136, 0.7));
            z-index: 1;
        }
        
        .dermis-label {
            text-align: center;
            padding: 10px;
            color: #a0522d;
            font-weight: bold;
            font-size: 16px;
        }
        
        /* ë•€ìƒ˜ êµ¬ì¡°ë¬¼ */
        .sweat-gland-container {
            position: absolute;
            width: 500px;
            height: 550px;
            left: 50%;
            top: 50px;
            transform: translateX(-50%);
            z-index: 10;
        }
        
        /* ì•„í¬ë¡œì‹œë¦°ì§€ì›€ (ë•€êµ¬ë©) */
        .acrosyringium {
            position: absolute;
            width: 60px;
            height: 60px;
            left: 50%;
            top: 10px;
            transform: translateX(-50%);
            background: radial-gradient(circle, 
                rgba(52, 152, 219, 0.8), 
                rgba(52, 152, 219, 0.2));
            border: 3px solid #2980b9;
            border-radius: 50%;
            z-index: 15;
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.5);
        }
        
        .acrosyringium::after {
            content: 'ë•€êµ¬ë©';
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: #2980b9;
            font-weight: bold;
        }
        
        /* ë„ê´€ */
        .duct {
            position: absolute;
            width: 60px;
            height: 280px;
            left: 50%;
            top: 60px;
            transform: translateX(-50%);
            background: linear-gradient(to bottom, 
                #4CAF50 0%, 
                #66BB6A 50%, 
                #81C784 100%);
            border: 3px solid #2E7D32;
            border-radius: 20px;
            z-index: 12;
            box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);
            position: relative;
        }
        
        .duct::after {
            content: 'ë„ê´€';
            position: absolute;
            right: -50px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 14px;
            color: #2E7D32;
            font-weight: bold;
        }
        
        /* ë„ê´€ ì´ì˜¨ ì±„ë„ í‘œì‹œ */
        .duct-channels {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .enac-channel {
            position: absolute;
            left: -5px;
            top: 30%;
            width: 70px;
            height: 30px;
            background: linear-gradient(90deg, rgba(231, 76, 60, 0.3), rgba(231, 76, 60, 0.8));
            border: 2px solid #e74c3c;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: #c0392b;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .cftr-channel {
            position: absolute;
            right: -5px;
            top: 50%;
            width: 70px;
            height: 30px;
            background: linear-gradient(90deg, rgba(39, 174, 96, 0.8), rgba(39, 174, 96, 0.3));
            border: 2px solid #27ae60;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: #229954;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        /* ë¶„ë¹„ ì½”ì¼ */
        .secretory-coil {
            position: absolute;
            width: 220px;
            height: 220px;
            left: 50%;
            bottom: 20px;
            transform: translateX(-50%);
            background: radial-gradient(circle at center, 
                #FFB300 0%, 
                #FF9800 40%, 
                #FF6F00 100%);
            border: 4px solid #E65100;
            border-radius: 50%;
            z-index: 11;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #fff;
            font-size: 16px;
            box-shadow: 0 6px 20px rgba(255, 152, 0, 0.5);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
        }
        
        /* ë¶„ë¹„ ì½”ì¼ ì´ì˜¨ ì±„ë„ë“¤ */
        .coil-channels {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        /* NKCC1 - ê¸°ì €ë§‰ (í•˜ë‹¨) */
        .nkcc1-channel {
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 35px;
            background: linear-gradient(180deg, rgba(156, 39, 176, 0.8), rgba(156, 39, 176, 0.3));
            border: 2px solid #7b1fa2;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 20;
        }
        
        /* ANO1 - ì •ë‹¨ë§‰ (ìƒë‹¨) */
        .ano1-channel {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 70px;
            height: 35px;
            background: linear-gradient(0deg, rgba(39, 174, 96, 0.8), rgba(39, 174, 96, 0.3));
            border: 2px solid #27ae60;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 20;
        }
        
        /* Na-K ATPase - ê¸°ì €ë§‰ ì¢Œì¸¡ */
        .na-k-atpase {
            position: absolute;
            bottom: 20px;
            left: -10px;
            width: 75px;
            height: 35px;
            background: linear-gradient(90deg, rgba(231, 76, 60, 0.8), rgba(230, 126, 34, 0.8));
            border: 2px solid #c0392b;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 20;
        }
        
        /* K+ ì±„ë„ - ê¸°ì €ë§‰ ìš°ì¸¡ */
        .k-channel {
            position: absolute;
            bottom: 20px;
            right: -10px;
            width: 60px;
            height: 35px;
            background: linear-gradient(90deg, rgba(142, 68, 173, 0.8), rgba(142, 68, 173, 0.3));
            border: 2px solid #8e44ad;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 20;
        }
        
        /* AQP5 - ë¬¼ ì±„ë„ (ì¢Œìš°) */
        .aqp5-left, .aqp5-right {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 30px;
            background: linear-gradient(90deg, rgba(52, 152, 219, 0.8), rgba(52, 152, 219, 0.3));
            border: 2px solid #3498db;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 20;
        }
        
        .aqp5-left {
            left: -10px;
        }
        
        .aqp5-right {
            right: -10px;
        }
        
        /* ì‹ ê²½ ë§ë‹¨ */
        .nerve-terminal {
            position: absolute;
            bottom: 10px;
            left: 10px;
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #e91e63, #c2185b);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 13px;
            font-weight: bold;
            z-index: 13;
            box-shadow: 0 4px 15px rgba(233, 30, 99, 0.5);
            text-align: center;
        }
        
        /* M3 ìˆ˜ìš©ì²´ í‘œì‹œ */
        .m3-receptor {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ffc107, #ff9800);
            border: 2px solid #f57c00;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: white;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        /* ì´ì˜¨ íŒŒí‹°í´ */
        .ion {
            position: absolute;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            font-size: 11px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            opacity: 0;
            z-index: 30;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        .na-ion {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .cl-ion {
            background: linear-gradient(135deg, #27ae60, #229954);
        }
        
        .k-ion {
            background: linear-gradient(135deg, #8e44ad, #7b1fa2);
        }
        
        .water {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .ach-molecule {
            position: absolute;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #9c27b0, #7b1fa2);
            border-radius: 50%;
            opacity: 0;
            z-index: 21;
            box-shadow: 0 2px 8px rgba(156, 39, 176, 0.5);
        }
        
        /* ë•€ë°©ìš¸ */
        .sweat-drop {
            position: absolute;
            width: 15px;
            height: 20px;
            background: linear-gradient(180deg, #3498db, #2980b9);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            opacity: 0;
            z-index: 25;
            box-shadow: 0 2px 6px rgba(52, 152, 219, 0.4);
        }
        
        /* ì»¨íŠ¸ë¡¤ ë²„íŠ¼ */
        .control-button {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .control-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .stage-info {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #e0e0e0;
        }
        
        .stage-info h3 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .stage-info p {
            color: #666;
            line-height: 1.6;
        }
        
        .pressure-indicator {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #e0e0e0;
        }
        
        .pressure-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .pressure-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }
        
        .legend {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }
        
        .legend-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .channel-legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px;
            background: white;
            border-radius: 5px;
            font-size: 11px;
        }
        
        .channel-legend-box {
            width: 40px;
            height: 20px;
            border-radius: 3px;
            border: 2px solid;
        }
        
        .stats-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .stat-box {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }
        
        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes moveUp {
            from {
                transform: translateY(0);
                opacity: 1;
            }
            to {
                transform: translateY(-300px);
                opacity: 0;
            }
        }
        
        @keyframes pulse {
            0%, 100% { 
                transform: scale(1) translateX(-50%);
            }
            50% { 
                transform: scale(1.1) translateX(-50%);
            }
        }
        
        @keyframes glow {
            0%, 100% { 
                box-shadow: 0 6px 20px rgba(255, 152, 0, 0.5);
            }
            50% { 
                box-shadow: 0 6px 30px rgba(255, 152, 0, 1);
            }
        }
        
        @keyframes channelPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }
        
        .active-stage {
            animation: pulse 1s infinite;
        }
        
        .glowing {
            animation: glow 1s infinite;
        }
        
        .channel-active {
            animation: channelPulse 0.5s;
            opacity: 1 !important;
        }
        
        /* ì±„ë„ë³„ íŠ¹ë³„ í‘œì‹œ */
        .show-channels .nkcc1-channel,
        .show-channels .ano1-channel,
        .show-channels .na-k-atpase,
        .show-channels .k-channel,
        .show-channels .aqp5-left,
        .show-channels .aqp5-right,
        .show-channels .m3-receptor {
            opacity: 0.6;
        }
        
        .show-channels .enac-channel,
        .show-channels .cftr-channel {
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ’§ ì—í¬ë¦° ë•€ìƒ˜ ì´ì˜¨ ì±„ë„ ì‹œë®¬ë ˆì´ì…˜</h1>
        
        <div class="simulation-container">
            <div class="gland-visual">
                <!-- í”¼ë¶€ì¸µ -->
                <div class="epidermis">
                    <div class="epidermis-label">í‘œí”¼ (Epidermis)</div>
                </div>
                <div class="dermis">
                    <div class="dermis-label">ì§„í”¼ (Dermis)</div>
                </div>
                
                <!-- ë•€ìƒ˜ êµ¬ì¡°ë¬¼ -->
                <div class="sweat-gland-container">
                    <div class="acrosyringium" id="acrosyringium"></div>
                    
                    <!-- ë„ê´€ê³¼ ì±„ë„ë“¤ -->
                    <div class="duct" id="duct">
                        <div class="duct-channels">
                            <div class="enac-channel" id="enac">ENaC</div>
                            <div class="cftr-channel" id="cftr">CFTR</div>
                        </div>
                    </div>
                    
                    <!-- ë¶„ë¹„ ì½”ì¼ê³¼ ì±„ë„ë“¤ -->
                    <div class="secretory-coil" id="coil">
                        <span>ë¶„ë¹„ ì½”ì¼</span>
                        <div class="coil-channels">
                            <div class="nkcc1-channel" id="nkcc1">NKCC1</div>
                            <div class="ano1-channel" id="ano1">ANO1</div>
                            <div class="na-k-atpase" id="na-k-atpase">Na-K<br>ATPase</div>
                            <div class="k-channel" id="k-channel">Kâº</div>
                            <div class="aqp5-left" id="aqp5-left">AQP5</div>
                            <div class="aqp5-right" id="aqp5-right">AQP5</div>
                        </div>
                    </div>
                </div>
                
                <!-- ì‹ ê²½ ë§ë‹¨ê³¼ M3 ìˆ˜ìš©ì²´ -->
                <div class="nerve-terminal" id="nerve">
                    êµê°<br>ì‹ ê²½
                    <div class="m3-receptor" id="m3">Mâ‚ƒ</div>
                </div>
                
                <!-- ì´ì˜¨ê³¼ ë¬¼ ë¶„ìë“¤ì„ ìœ„í•œ ì»¨í…Œì´ë„ˆ -->
                <div id="particles"></div>
                
                <!-- ë•€ë°©ìš¸ë“¤ì„ ìœ„í•œ ì»¨í…Œì´ë„ˆ -->
                <div id="sweatDrops"></div>
            </div>
            
            <div class="control-panel">
                <h2 style="color: #333; margin-bottom: 20px; text-align: center;">ğŸ® ì‹œë®¬ë ˆì´ì…˜ ì»¨íŠ¸ë¡¤</h2>
                
                <button class="control-button" onclick="startSimulation()">ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘</button>
                <button class="control-button" onclick="resetSimulation()">ë¦¬ì…‹</button>
                <button class="control-button" onclick="toggleChannels()">ì±„ë„ í‘œì‹œ/ìˆ¨ê¸°ê¸°</button>
                
                <div class="stage-info">
                    <h3>í˜„ì¬ ë‹¨ê³„</h3>
                    <p id="currentStage">ëŒ€ê¸° ì¤‘...</p>
                </div>
                
                <div class="pressure-indicator">
                    <h4 style="margin-bottom: 10px;">ì‚¼íˆ¬ì•• (mm Hg)</h4>
                    <div class="pressure-bar">
                        <div class="pressure-fill" id="pressureBar">0</div>
                    </div>
                </div>
                
                <div class="stats-panel">
                    <div class="stat-box">
                        <div class="stat-label">Naâº ë†ë„</div>
                        <div class="stat-value" id="naConc">145 mM</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Clâ» ë†ë„</div>
                        <div class="stat-value" id="clConc">110 mM</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">ì‚¼íˆ¬ì§ˆë†ë„</div>
                        <div class="stat-value" id="osmolality">300 mOsm</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">ë•€ ìƒì„±ëŸ‰</div>
                        <div class="stat-value" id="sweatVolume">0 Î¼L</div>
                    </div>
                </div>
                
                <div class="stage-info" style="margin-top: 20px;">
                    <h3>ê³¼ì • ì„¤ëª…</h3>
                    <p id="stageDescription">ì‹œë®¬ë ˆì´ì…˜ì„ ì‹œì‘í•˜ë©´ ì—í¬ë¦° ë•€ìƒ˜ì˜ ì´ì˜¨ ì±„ë„ì„ í†µí•œ ì‘ë™ ê³¼ì •ì„ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-dot" style="background: linear-gradient(135deg, #e74c3c, #c0392b);"></div>
                <span>Naâº (ë‚˜íŠ¸ë¥¨)</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot" style="background: linear-gradient(135deg, #27ae60, #229954);"></div>
                <span>Clâ» (ì—¼ì†Œ)</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot" style="background: linear-gradient(135deg, #8e44ad, #7b1fa2);"></div>
                <span>Kâº (ì¹¼ë¥¨)</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot" style="background: linear-gradient(135deg, #3498db, #2980b9);"></div>
                <span>Hâ‚‚O (ë¬¼)</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot" style="background: linear-gradient(135deg, #9c27b0, #7b1fa2);"></div>
                <span>ACh (ì•„ì„¸í‹¸ì½œë¦°)</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot" style="background: linear-gradient(135deg, #ffc107, #ff9800);"></div>
                <span>Mâ‚ƒ ìˆ˜ìš©ì²´</span>
            </div>
        </div>
        
        <div class="legend" style="margin-top: 10px;">
            <div class="channel-legend-item">
                <div class="channel-legend-box" style="background: rgba(156, 39, 176, 0.3); border-color: #7b1fa2;"></div>
                <span>NKCC1 (Na-K-2Cl)</span>
            </div>
            <div class="channel-legend-item">
                <div class="channel-legend-box" style="background: rgba(39, 174, 96, 0.3); border-color: #27ae60;"></div>
                <span>ANO1 (Clâ» ì±„ë„)</span>
            </div>
            <div class="channel-legend-item">
                <div class="channel-legend-box" style="background: rgba(231, 76, 60, 0.3); border-color: #c0392b;"></div>
                <span>ENaC (Naâº ì±„ë„)</span>
            </div>
            <div class="channel-legend-item">
                <div class="channel-legend-box" style="background: rgba(39, 174, 96, 0.3); border-color: #27ae60;"></div>
                <span>CFTR (Clâ» ì±„ë„)</span>
            </div>
            <div class="channel-legend-item">
                <div class="channel-legend-box" style="background: rgba(52, 152, 219, 0.3); border-color: #3498db;"></div>
                <span>AQP5 (ë¬¼ ì±„ë„)</span>
            </div>
            <div class="channel-legend-item">
                <div class="channel-legend-box" style="background: rgba(231, 76, 60, 0.3); border-color: #c0392b;"></div>
                <span>Na-K ATPase</span>
            </div>
        </div>
    </div>

    <script>
        let simulationRunning = false;
        let currentStageIndex = 0;
        let sweatVolume = 0;
        let pressure = 0;
        let showChannels = false;
        
        const stages = [
            {
                name: "1ë‹¨ê³„: ì‹ ê²½ ìê·¹ê³¼ Mâ‚ƒ ìˆ˜ìš©ì²´ í™œì„±í™”",
                description: "êµê°ì‹ ê²½ì—ì„œ AChê°€ ë¶„ë¹„ë˜ì–´ Mâ‚ƒ ìˆ˜ìš©ì²´ì— ê²°í•©í•˜ê³  CaÂ²âºê°€ ì¦ê°€í•©ë‹ˆë‹¤.",
                duration: 3000,
                action: stage1
            },
            {
                name: "2ë‹¨ê³„: NKCC1ì„ í†µí•œ ì´ì˜¨ ìœ ì…",
                description: "NKCC1 ì±„ë„ì„ í†µí•´ Naâº-Kâº-2Clâ»ê°€ ì„¸í¬ ë‚´ë¡œ ìœ ì…ë©ë‹ˆë‹¤.",
                duration: 3000,
                action: stage2
            },
            {
                name: "3ë‹¨ê³„: ANO1ì„ í†µí•œ Clâ» ë¶„ë¹„",
                description: "CaÂ²âº í™œì„±í™”ë¡œ ANO1 ì±„ë„ì´ ì—´ë¦¬ê³  Clâ»ê°€ ë¶„ë¹„ ì½”ì¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.",
                duration: 3000,
                action: stage3
            },
            {
                name: "4ë‹¨ê³„: Naâº ì„¸í¬ê°„ ì´ë™ê³¼ AQP5ë¥¼ í†µí•œ ë¬¼ ìœ ì…",
                description: "ì „ê¸°í™”í•™ì  êµ¬ë°°ë¡œ Naâºê°€ ì´ë™í•˜ê³ , AQP5ë¥¼ í†µí•´ ë¬¼ì´ ìœ ì…ë˜ì–´ 500 mm Hg ì••ë ¥ì´ ìƒì„±ë©ë‹ˆë‹¤.",
                duration: 3000,
                action: stage4
            },
            {
                name: "5ë‹¨ê³„: ENaC/CFTRì„ í†µí•œ ë„ê´€ ì¬í¡ìˆ˜",
                description: "ë„ê´€ì˜ ENaCë¡œ Naâº, CFTRë¡œ Clâ»ê°€ ì¬í¡ìˆ˜ë˜ì–´ ì €ì¥ì„± ë•€(100 mOsm)ì´ ë©ë‹ˆë‹¤.",
                duration: 3500,
                action: stage5
            },
            {
                name: "6ë‹¨ê³„: ë•€ ë°°ì¶œ",
                description: "ì €ì¥ì„± ë•€ì´ ì•„í¬ë¡œì‹œë¦°ì§€ì›€ì„ í†µí•´ í”¼ë¶€ í‘œë©´ìœ¼ë¡œ ë°°ì¶œë©ë‹ˆë‹¤.",
                duration: 3000,
                action: stage6
            }
        ];
        
        function toggleChannels() {
            const visualElement = document.querySelector('.gland-visual');
            showChannels = !showChannels;
            
            if (showChannels) {
                visualElement.classList.add('show-channels');
            } else {
                visualElement.classList.remove('show-channels');
            }
        }
        
        function activateChannel(channelId, duration = 1000) {
            const channel = document.getElementById(channelId);
            if (channel) {
                channel.classList.add('channel-active');
                channel.style.opacity = '1';
                setTimeout(() => {
                    channel.classList.remove('channel-active');
                    if (!showChannels) {
                        channel.style.opacity = '0';
                    }
                }, duration);
            }
        }
        
        function startSimulation() {
            if (simulationRunning) return;
            simulationRunning = true;
            currentStageIndex = 0;
            sweatVolume = 0;
            pressure = 0;
            runStage();
        }
        
        function runStage() {
            if (!simulationRunning || currentStageIndex >= stages.length) {
                simulationRunning = false;
                document.getElementById('currentStage').textContent = 'ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ!';
                currentStageIndex = 0;
                return;
            }
            
            const stage = stages[currentStageIndex];
            document.getElementById('currentStage').textContent = stage.name;
            document.getElementById('stageDescription').textContent = stage.description;
            
            stage.action();
            
            setTimeout(() => {
                currentStageIndex++;
                runStage();
            }, stage.duration);
        }
        
        function stage1() {
            // ì‹ ê²½ ìê·¹ - M3 ìˆ˜ìš©ì²´ í™œì„±í™”
            const nerve = document.getElementById('nerve');
            nerve.classList.add('glowing');
            
            // M3 ìˆ˜ìš©ì²´ í‘œì‹œ
            activateChannel('m3', 2500);
            
            // ACh ë¶„ì ìƒì„± ë° M3ë¡œ ì´ë™
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    createACh();
                }, i * 300);
            }
            
            setTimeout(() => {
                nerve.classList.remove('glowing');
            }, 2500);
        }
        
        function stage2() {
            // NKCC1ì„ í†µí•œ ì´ì˜¨ ìœ ì…
            const coil = document.getElementById('coil');
            coil.classList.add('active-stage');
            
            // NKCC1 ì±„ë„ í™œì„±í™”
            activateChannel('nkcc1', 2500);
            
            // Na+, K+, Cl- ì´ì˜¨ë“¤ì´ NKCC1ì„ í†µí•´ ìœ ì…
            for (let i = 0; i < 6; i++) {
                setTimeout(() => {
                    createNKCC1Ion('na', i);
                    createNKCC1Ion('k', i);
                    createNKCC1Ion('cl', i);
                    createNKCC1Ion('cl', i);
                }, i * 400);
            }
            
            // Na-K ATPaseë„ í™œì„±í™”
            setTimeout(() => {
                activateChannel('na-k-atpase', 1500);
            }, 1000);
            
            setTimeout(() => {
                coil.classList.remove('active-stage');
            }, 2500);
        }
        
        function stage3() {
            // ANO1ì„ í†µí•œ Cl- ë¶„ë¹„
            activateChannel('ano1', 2500);
            
            // Cl- ì´ì˜¨ì´ ANO1ì„ í†µí•´ ë¶„ë¹„
            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    createANO1Secretion();
                }, i * 300);
            }
            
            // K+ ì±„ë„ í™œì„±í™”
            setTimeout(() => {
                activateChannel('k-channel', 1500);
            }, 1000);
        }
        
        function stage4() {
            // Na+ ì´ë™ê³¼ ë¬¼ ìœ ì…
            // AQP5 ì±„ë„ í™œì„±í™”
            activateChannel('aqp5-left', 2500);
            activateChannel('aqp5-right', 2500);
            
            // Na+ ì„¸í¬ê°„ ì´ë™
            for (let i = 0; i < 6; i++) {
                setTimeout(() => {
                    createParacellularNa();
                }, i * 400);
            }
            
            // AQP5ë¥¼ í†µí•œ ë¬¼ ìœ ì…
            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    createWaterInflux();
                }, i * 250);
            }
            
            // ì••ë ¥ ì¦ê°€
            animatePressure(500);
            sweatVolume += 50;
            document.getElementById('sweatVolume').textContent = sweatVolume + ' Î¼L';
        }
        
        function stage5() {
            // ENaC/CFTRì„ í†µí•œ ë„ê´€ ì¬í¡ìˆ˜
            const duct = document.getElementById('duct');
            duct.classList.add('glowing');
            
            // ENaCì™€ CFTR ì±„ë„ í™œì„±í™”
            activateChannel('enac', 3000);
            activateChannel('cftr', 3000);
            
            // ENaCë¥¼ í†µí•œ Na+ ì¬í¡ìˆ˜
            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    createENaCReabsorption(i);
                }, i * 350);
            }
            
            // CFTRì„ í†µí•œ Cl- ì¬í¡ìˆ˜
            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    createCFTRReabsorption(i);
                }, i * 350 + 150);
            }
            
            // ë†ë„ ê°ì†Œ
            let naConc = 145;
            let clConc = 110;
            let osmolality = 300;
            
            const interval = setInterval(() => {
                if (!simulationRunning) {
                    clearInterval(interval);
                    return;
                }
                
                naConc -= 15;
                clConc -= 12;
                osmolality -= 30;
                
                if (osmolality <= 100) {
                    clearInterval(interval);
                    naConc = 50;
                    clConc = 40;
                    osmolality = 100;
                }
                
                updateStats(naConc, clConc, osmolality);
            }, 400);
            
            setTimeout(() => {
                duct.classList.remove('glowing');
            }, 3000);
        }
        
        function stage6() {
            // ë•€ ë°°ì¶œ
            const acrosyringium = document.getElementById('acrosyringium');
            acrosyringium.classList.add('glowing');
            
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    createSweatDrop();
                }, i * 400);
            }
            
            sweatVolume += 100;
            document.getElementById('sweatVolume').textContent = sweatVolume + ' Î¼L';
            
            animatePressure(0);
            
            setTimeout(() => {
                acrosyringium.classList.remove('glowing');
            }, 2500);
        }
        
        function createACh() {
            const particles = document.getElementById('particles');
            const ach = document.createElement('div');
            ach.className = 'ach-molecule';
            
            // ì‹ ê²½ì—ì„œ ì‹œì‘
            ach.style.left = '50px';
            ach.style.bottom = '50px';
            ach.style.opacity = '1';
            
            particles.appendChild(ach);
            
            // M3 ìˆ˜ìš©ì²´ë¡œ ì´ë™
            setTimeout(() => {
                ach.style.transition = 'all 1s ease';
                ach.style.left = '80px';
                ach.style.bottom = '80px';
            }, 100);
            
            setTimeout(() => {
                ach.style.opacity = '0';
            }, 1000);
            
            setTimeout(() => {
                ach.remove();
            }, 1500);
        }
        
        function createNKCC1Ion(type, index) {
            const particles = document.getElementById('particles');
            const ion = document.createElement('div');
            ion.className = 'ion';
            
            if (type === 'na') {
                ion.classList.add('na-ion');
                ion.textContent = 'Naâº';
            } else if (type === 'cl') {
                ion.classList.add('cl-ion');
                ion.textContent = 'Clâ»';
            } else if (type === 'k') {
                ion.classList.add('k-ion');
                ion.textContent = 'Kâº';
            }
            
            // NKCC1 ì±„ë„ ìœ„ì¹˜ì—ì„œ ì‹œì‘
            const nkcc1 = document.getElementById('nkcc1');
            const rect = nkcc1.getBoundingClientRect();
            const containerRect = particles.parentElement.getBoundingClientRect();
            
            ion.style.left = (rect.left - containerRect.left + rect.width/2) + 'px';
            ion.style.bottom = '200px';
            ion.style.opacity = '1';
            
            particles.appendChild(ion);
            
            // ì½”ì¼ ì¤‘ì‹¬ìœ¼ë¡œ ì´ë™
            setTimeout(() => {
                ion.style.transition = 'all 1s ease';
                const coilRect = document.getElementById('coil').getBoundingClientRect();
                ion.style.left = (coilRect.left - containerRect.left + coilRect.width/2) + 'px';
                ion.style.bottom = '120px';
                ion.style.opacity = '0.7';
            }, 100);
            
            setTimeout(() => {
                ion.remove();
            }, 1500);
        }
        
        function createANO1Secretion() {
            const particles = document.getElementById('particles');
            const cl = document.createElement('div');
            cl.className = 'ion cl-ion';
            cl.textContent = 'Clâ»';
            
            // ì½”ì¼ ì¤‘ì‹¬ì—ì„œ ì‹œì‘
            const coilRect = document.getElementById('coil').getBoundingClientRect();
            const containerRect = particles.parentElement.getBoundingClientRect();
            
            cl.style.left = (coilRect.left - containerRect.left + coilRect.width/2) + 'px';
            cl.style.bottom = '120px';
            cl.style.opacity = '1';
            
            particles.appendChild(cl);
            
            // ANO1ì„ í†µí•´ ìœ„ë¡œ ë¶„ë¹„
            setTimeout(() => {
                cl.style.transition = 'all 1s ease';
                const ano1Rect = document.getElementById('ano1').getBoundingClientRect();
                cl.style.left = (ano1Rect.left - containerRect.left + ano1Rect.width/2) + 'px';
                cl.style.bottom = '200px';
            }, 100);
            
            // ë„ê´€ìœ¼ë¡œ ì´ë™
            setTimeout(() => {
                cl.style.animation = 'moveUp 2s ease-out forwards';
            }, 1200);
            
            setTimeout(() => {
                cl.remove();
            }, 3500);
        }
        
        function createParacellularNa() {
            const particles = document.getElementById('particles');
            const na = document.createElement('div');
            na.className = 'ion na-ion';
            na.textContent = 'Naâº';
            
            // ì½”ì¼ ì™¸ë¶€ì—ì„œ ì‹œì‘
            const coilRect = document.getElementById('coil').getBoundingClientRect();
            const containerRect = particles.parentElement.getBoundingClientRect();
            
            na.style.left = (coilRect.left - containerRect.left - 20) + 'px';
            na.style.bottom = '100px';
            na.style.opacity = '1';
            
            particles.appendChild(na);
            
            // ì½”ì¼ ë‚´ë¶€ë¡œ ì´ë™
            setTimeout(() => {
                na.style.transition = 'all 1s ease';
                na.style.left = (coilRect.left - containerRect.left + coilRect.width/2) + 'px';
                na.style.bottom = '120px';
            }, 100);
            
            setTimeout(() => {
                na.style.animation = 'moveUp 2s ease-out forwards';
            }, 1200);
            
            setTimeout(() => {
                na.remove();
            }, 3500);
        }
        
        function createWaterInflux() {
            const particles = document.getElementById('particles');
            const water = document.createElement('div');
            water.className = 'ion water';
            water.textContent = 'Hâ‚‚O';
            
            // AQP5 ì±„ë„ ìœ„ì¹˜ì—ì„œ ì‹œì‘
            const aqp5 = Math.random() > 0.5 ? document.getElementById('aqp5-left') : document.getElementById('aqp5-right');
            const rect = aqp5.getBoundingClientRect();
            const containerRect = particles.parentElement.getBoundingClientRect();
            
            water.style.left = (rect.left - containerRect.left + rect.width/2) + 'px';
            water.style.top = (rect.top - containerRect.top) + 'px';
            water.style.opacity = '1';
            
            particles.appendChild(water);
            
            // ì½”ì¼ ì¤‘ì‹¬ìœ¼ë¡œ ì´ë™
            setTimeout(() => {
                water.style.transition = 'all 1s ease';
                const coilRect = document.getElementById('coil').getBoundingClientRect();
                water.style.left = (coilRect.left - containerRect.left + coilRect.width/2) + 'px';
                water.style.top = (coilRect.top - containerRect.top + coilRect.height/2) + 'px';
            }, 100);
            
            setTimeout(() => {
                water.style.animation = 'moveUp 2s ease-out forwards';
            }, 1200);
            
            setTimeout(() => {
                water.remove();
            }, 3500);
        }
        
        function createENaCReabsorption(index) {
            const particles = document.getElementById('particles');
            const na = document.createElement('div');
            na.className = 'ion na-ion';
            na.textContent = 'Naâº';
            
            // ë„ê´€ ì¤‘ì‹¬ì—ì„œ ì‹œì‘
            const ductRect = document.getElementById('duct').getBoundingClientRect();
            const containerRect = particles.parentElement.getBoundingClientRect();
            
            const startY = ductRect.top - containerRect.top + ductRect.height - 50 - (index * 30);
            
            na.style.left = (ductRect.left - containerRect.left + ductRect.width/2) + 'px';
            na.style.top = startY + 'px';
            na.style.opacity = '1';
            
            particles.appendChild(na);
            
            // ìœ„ë¡œ ì´ë™
            setTimeout(() => {
                na.style.transition = 'top 1s ease';
                na.style.top = (startY - 50) + 'px';
            }, 100);
            
            // ENaCë¥¼ í†µí•´ ì¬í¡ìˆ˜
            setTimeout(() => {
                na.style.transition = 'all 0.5s ease-out';
                const enacRect = document.getElementById('enac').getBoundingClientRect();
                na.style.left = (enacRect.left - containerRect.left - 30) + 'px';
                na.style.opacity = '0';
                na.style.transform = 'scale(0.3)';
            }, 1200);
            
            setTimeout(() => {
                na.remove();
            }, 2000);
        }
        
        function createCFTRReabsorption(index) {
            const particles = document.getElementById('particles');
            const cl = document.createElement('div');
            cl.className = 'ion cl-ion';
            cl.textContent = 'Clâ»';
            
            // ë„ê´€ ì¤‘ì‹¬ì—ì„œ ì‹œì‘
            const ductRect = document.getElementById('duct').getBoundingClientRect();
            const containerRect = particles.parentElement.getBoundingClientRect();
            
            const startY = ductRect.top - containerRect.top + ductRect.height - 50 - (index * 30);
            
            cl.style.left = (ductRect.left - containerRect.left + ductRect.width/2) + 'px';
            cl.style.top = startY + 'px';
            cl.style.opacity = '1';
            
            particles.appendChild(cl);
            
            // ìœ„ë¡œ ì´ë™
            setTimeout(() => {
                cl.style.transition = 'top 1s ease';
                cl.style.top = (startY - 50) + 'px';
            }, 100);
            
            // CFTRì„ í†µí•´ ì¬í¡ìˆ˜
            setTimeout(() => {
                cl.style.transition = 'all 0.5s ease-out';
                const cftrRect = document.getElementById('cftr').getBoundingClientRect();
                cl.style.left = (cftrRect.left - containerRect.left + cftrRect.width + 30) + 'px';
                cl.style.opacity = '0';
                cl.style.transform = 'scale(0.3)';
            }, 1200);
            
            setTimeout(() => {
                cl.remove();
            }, 2000);
        }
        
        function createSweatDrop() {
            const drops = document.getElementById('sweatDrops');
            const drop = document.createElement('div');
            drop.className = 'sweat-drop';
            
            // ì•„í¬ë¡œì‹œë¦°ì§€ì›€ ìœ„ì¹˜ì—ì„œ ì‹œì‘
            const acro = document.getElementById('acrosyringium');
            const acroRect = acro.getBoundingClientRect();
            const containerRect = drops.parentElement.getBoundingClientRect();
            
            drop.style.left = (acroRect.left - containerRect.left + acroRect.width/2 - 7.5) + 'px';
            drop.style.top = (acroRect.top - containerRect.top) + 'px';
            drop.style.opacity = '1';
            
            drops.appendChild(drop);
            
            // ìœ„ë¡œ ì´ë™ í›„ ì‚¬ë¼ì§€ê¸°
            setTimeout(() => {
                drop.style.transition = 'all 1s ease';
                drop.style.top = '20px';
                drop.style.opacity = '0';
            }, 100);
            
            setTimeout(() => {
                drop.remove();
            }, 1500);
        }
        
        function animatePressure(targetPressure) {
            const pressureBar = document.getElementById('pressureBar');
            const currentPressure = pressure;
            const step = (targetPressure - currentPressure) / 20;
            let current = currentPressure;
            
            const interval = setInterval(() => {
                if (!simulationRunning) {
                    clearInterval(interval);
                    return;
                }
                
                current += step;
                if ((step > 0 && current >= targetPressure) || 
                    (step < 0 && current <= targetPressure)) {
                    current = targetPressure;
                    clearInterval(interval);
                }
                
                pressure = current;
                const percentage = (current / 500) * 100;
                pressureBar.style.width = percentage + '%';
                pressureBar.textContent = Math.round(current) + ' mm Hg';
                
                // ìƒ‰ìƒ ë³€ê²½
                if (percentage > 80) {
                    pressureBar.style.background = 'linear-gradient(90deg, #e74c3c, #c0392b)';
                } else if (percentage > 50) {
                    pressureBar.style.background = 'linear-gradient(90deg, #f39c12, #e67e22)';
                } else {
                    pressureBar.style.background = 'linear-gradient(90deg, #4CAF50, #8BC34A)';
                }
            }, 50);
        }
        
        function updateStats(na, cl, osm) {
            document.getElementById('naConc').textContent = na + ' mM';
            document.getElementById('clConc').textContent = cl + ' mM';
            document.getElementById('osmolality').textContent = osm + ' mOsm';
        }
        
        function resetSimulation() {
            simulationRunning = false;
            currentStageIndex = 0;
            sweatVolume = 0;
            pressure = 0;
            
            // íŒŒí‹°í´ ì œê±°
            document.getElementById('particles').innerHTML = '';
            document.getElementById('sweatDrops').innerHTML = '';
            
            // ìƒíƒœ ì´ˆê¸°í™”
            document.getElementById('currentStage').textContent = 'ëŒ€ê¸° ì¤‘...';
            document.getElementById('stageDescription').textContent = 'ì‹œë®¬ë ˆì´ì…˜ì„ ì‹œì‘í•˜ë©´ ì—í¬ë¦° ë•€ìƒ˜ì˜ ì´ì˜¨ ì±„ë„ì„ í†µí•œ ì‘ë™ ê³¼ì •ì„ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            document.getElementById('pressureBar').style.width = '0%';
            document.getElementById('pressureBar').textContent = '0';
            document.getElementById('sweatVolume').textContent = '0 Î¼L';
            
            updateStats(145, 110, 300);
            
            // í´ë˜ìŠ¤ ì œê±°
            document.getElementById('nerve').classList.remove('glowing');
            document.getElementById('coil').classList.remove('active-stage');
            document.getElementById('duct').classList.remove('glowing');
            document.getElementById('acrosyringium').classList.remove('glowing');
            
            // ëª¨ë“  ì±„ë„ ìˆ¨ê¸°ê¸°
            if (!showChannels) {
                const channels = document.querySelectorAll('.nkcc1-channel, .ano1-channel, .na-k-atpase, .k-channel, .aqp5-left, .aqp5-right, .m3-receptor, .enac-channel, .cftr-channel');
                channels.forEach(channel => {
                    channel.style.opacity = '0';
                });
            }
        }
        
        // ì´ˆê¸°í™”
        resetSimulation();
    </script>
</body>
</html>